<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motion Detection Overlay</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #000;
        }
        h1 {
            color: #fff;
        }
        .container {
            position: relative;
            width: 800px;
            max-width: 100%;
            height: 450px;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }
    </style>
</head>
<body>
    <h1>Motion Detection Overlay on Embedded Video</h1>
    <div class="container">
        <!-- Embedded YouTube Video -->
        <iframe 
            src="https://www.youtube.com/embed/h2HXup8nA1I?autoplay=1&mute=1"
            title="YouTube video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen>
        </iframe>

        <!-- Canvas Overlay -->
        <canvas id="overlay"></canvas>
    </div>

    <!-- TensorFlow.js and Pose Detection -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection"></script>
    <script>
        const canvas = document.getElementById('overlay');
        const ctx = canvas.getContext('2d');

        // Set the canvas size to match the iframe's dimensions
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;

        // Load Pose Detection Model
        async function loadPoseModel() {
            const detectorConfig = {
                modelType: poseDetection.movenet.modelType.SINGLEPOSE_LIGHTNING,
            };
            const detector = await poseDetection.createDetector(
                poseDetection.SupportedModels.MoveNet,
                detectorConfig
            );
            return detector;
        }

        // Simulate Pose Detection on Canvas Overlay
        async function simulateTracking(detector) {
            const fakeData = [
                { x: 100, y: 100, info: "Heart Rate: 75 bpm" },
                { x: 300, y: 200, info: "Stress Level: Moderate" },
                { x: 500, y: 350, info: "Emotion: Happy" },
            ];

            function drawFakeInfo(x, y, info) {
                ctx.fillStyle = "rgba(255, 0, 0, 0.8)";
                ctx.fillRect(x, y, 150, 50);
                ctx.fillStyle = "#fff";
                ctx.font = "14px Arial";
                ctx.fillText(info, x + 10, y + 25);
            }

            function renderOverlay() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Fake Tracking Data
                fakeData.forEach(({ x, y, info }) => {
                    drawFakeInfo(x, y, info);
                });

                // Update fake positions for movement
                fakeData.forEach((point) => {
                    point.x += (Math.random() - 0.5) * 10;
                    point.y += (Math.random() - 0.5) * 10;

                    // Keep points within bounds
                    point.x = Math.max(0, Math.min(canvas.width - 150, point.x));
                    point.y = Math.max(0, Math.min(canvas.height - 50, point.y));
                });

                requestAnimationFrame(renderOverlay);
            }

            renderOverlay();
        }

        (async () => {
            const detector = await loadPoseModel();
            simulateTracking(detector);
        })();
    </script>
</body>
</html>
